import{j as t,r as R,a as C,u as L}from"./iframe-BlPw6RHN.js";import{Q as V}from"./queryClient-Dw0i7u28.js";import{Q as z}from"./useAccounts-But_qxzc.js";import{m as U}from"./budgetData-Dm9Z5fBL.js";import{A as Z}from"./AccountCard-BDWTxzm7.js";import{E as H}from"./EditAccountForm-D0nm6J6c.js";import{u as Q}from"./UnstyledButton-DT2tpwi4.js";import{M as $,a as W,N as K,b as Y,c as J,d as X,e as ee,f as te,u as se,D as ae}from"./Drawer-CyWSN7Tr.js";import{T as ne}from"./Text-CKudE1NG.js";import{S as oe}from"./SimpleGrid-CH29pY9P.js";import{g as k}from"./use-form-ae0NiLND.js";import{f,u as x,a as re,c as ce,g as le,b as ie}from"./polymorphic-factory-0CtcYZKl.js";import{c as de}from"./create-safe-context-B7JJMNKb.js";import{S as ue}from"./ScrollArea-DfS6V9t2.js";import{c as me}from"./TextInput-BD6MJsqd.js";import"./preload-helper-PPVm8Dsz.js";import"./Paper-ZXYsCSl_.js";import"./Group-VLj-LUgQ.js";import"./Title-Bx3YnrbZ.js";import"./ActionIcon-_QTefNip.js";import"./Loader-CTmnaFpN.js";import"./AreaGradient-Ct6ST7oD.js";import"./index-tni0gN6T.js";import"./Stack-quhSlGT0.js";import"./Button-Bd-cDwKe.js";import"./Alert-DVjRT69K.js";import"./Grid-3nMlZOK-.js";import"./get-base-value-FMRBrurP.js";import"./ColorSwatch-Cu4-wEOa.js";import"./index-R61n_Ntc.js";import"./Combination-BJpTQ1Np.js";import"./noop-BjFrJKj1.js";var h={root:"m_9df02822",content:"m_54c44539",inner:"m_1f958f16",header:"m_d0e2b9cd"};const[pe,S]=de("Modal component was not found in tree"),j=f((r,e)=>{const s=x("ModalBody",null,r),{classNames:a,className:o,style:n,styles:c,vars:u,...m}=s,d=S();return t.jsx($,{ref:e,...d.getStyles("body",{classNames:a,style:n,styles:c,className:o}),...m})});j.classes=h;j.displayName="@mantine/core/ModalBody";const b=f((r,e)=>{const s=x("ModalCloseButton",null,r),{classNames:a,className:o,style:n,styles:c,vars:u,...m}=s,d=S();return t.jsx(W,{ref:e,...d.getStyles("close",{classNames:a,style:n,styles:c,className:o}),...m})});b.classes=h;b.displayName="@mantine/core/ModalCloseButton";const E=f((r,e)=>{const s=x("ModalContent",null,r),{classNames:a,className:o,style:n,styles:c,vars:u,children:m,__hidden:d,...l}=s,p=S(),g=p.scrollAreaComponent||K;return t.jsx(Y,{...p.getStyles("content",{className:o,style:n,styles:c,classNames:a}),innerProps:p.getStyles("inner",{className:o,style:n,styles:c,classNames:a}),"data-full-screen":p.fullScreen||void 0,"data-modal-content":!0,"data-hidden":d||void 0,ref:e,...l,children:t.jsx(g,{style:{maxHeight:p.fullScreen?"100dvh":`calc(100dvh - (${R(p.yOffset)} * 2))`},children:m})})});E.classes=h;E.displayName="@mantine/core/ModalContent";const N=f((r,e)=>{const s=x("ModalHeader",null,r),{classNames:a,className:o,style:n,styles:c,vars:u,...m}=s,d=S();return t.jsx(J,{ref:e,...d.getStyles("header",{classNames:a,style:n,styles:c,className:o}),...m})});N.classes=h;N.displayName="@mantine/core/ModalHeader";const O=f((r,e)=>{const s=x("ModalOverlay",null,r),{classNames:a,className:o,style:n,styles:c,vars:u,...m}=s,d=S();return t.jsx(X,{ref:e,...d.getStyles("overlay",{classNames:a,style:n,styles:c,className:o}),...m})});O.classes=h;O.displayName="@mantine/core/ModalOverlay";const ye={__staticSelector:"Modal",closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:k("modal"),transitionProps:{duration:200,transition:"fade-down"},yOffset:"5dvh"},ge=ce((r,{radius:e,size:s,yOffset:a,xOffset:o})=>({root:{"--modal-radius":e===void 0?void 0:ie(e),"--modal-size":le(s,"modal-size"),"--modal-y-offset":R(a),"--modal-x-offset":R(o)}})),_=f((r,e)=>{const s=x("ModalRoot",ye,r),{classNames:a,className:o,style:n,styles:c,unstyled:u,vars:m,yOffset:d,scrollAreaComponent:l,radius:p,fullScreen:g,centered:i,xOffset:v,__staticSelector:M,attributes:D,...G}=s,F=re({name:M,classes:h,props:s,className:o,style:n,classNames:a,styles:c,unstyled:u,attributes:D,vars:m,varsResolver:ge});return t.jsx(pe,{value:{yOffset:d,scrollAreaComponent:l,getStyles:F,fullScreen:g},children:t.jsx(ee,{ref:e,...F("root"),"data-full-screen":g||void 0,"data-centered":i||void 0,"data-offset-scrollbars":l===ue.Autosize||void 0,unstyled:u,...G})})});_.classes=h;_.displayName="@mantine/core/ModalRoot";const[he,fe]=me();function q({children:r}){const[e,s]=C.useState([]),[a,o]=C.useState(k("modal"));return t.jsx(he,{value:{stack:e,addModal:(n,c)=>{s(u=>[...new Set([...u,n])]),o(u=>typeof c=="number"&&typeof u=="number"?Math.max(u,c):u)},removeModal:n=>s(c=>c.filter(u=>u!==n)),getZIndex:n=>`calc(${a} + ${e.indexOf(n)} + 1)`,currentId:e[e.length-1],maxZIndex:a},children:r})}q.displayName="@mantine/core/ModalStack";const I=f((r,e)=>{const s=x("ModalTitle",null,r),{classNames:a,className:o,style:n,styles:c,vars:u,...m}=s,d=S();return t.jsx(te,{ref:e,...d.getStyles("title",{classNames:a,style:n,styles:c,className:o}),...m})});I.classes=h;I.displayName="@mantine/core/ModalTitle";const xe={closeOnClickOutside:!0,withinPortal:!0,lockScroll:!0,trapFocus:!0,returnFocus:!0,closeOnEscape:!0,keepMounted:!1,zIndex:k("modal"),transitionProps:{duration:200,transition:"fade-down"},withOverlay:!0,withCloseButton:!0},y=f((r,e)=>{const{title:s,withOverlay:a,overlayProps:o,withCloseButton:n,closeButtonProps:c,children:u,radius:m,opened:d,stackId:l,zIndex:p,...g}=x("Modal",xe,r),i=fe(),v=!!s||n,M=i&&l?{closeOnEscape:i.currentId===l,trapFocus:i.currentId===l,zIndex:i.getZIndex(l)}:{},D=a===!1?!1:l&&i?i.currentId===l:d;return C.useEffect(()=>{i&&l&&(d?i.addModal(l,p||k("modal")):i.removeModal(l))},[d,l,p]),t.jsxs(_,{ref:e,radius:m,opened:d,zIndex:i&&l?i.getZIndex(l):p,...g,...M,children:[a&&t.jsx(O,{visible:D,transitionProps:i&&l?{duration:0}:void 0,...o}),t.jsxs(E,{radius:m,__hidden:i&&l&&d?l!==i.currentId:!1,children:[v&&t.jsxs(N,{children:[s&&t.jsx(I,{children:s}),n&&t.jsx(b,{...c})]}),t.jsx(j,{children:u})]})]})});y.classes=h;y.displayName="@mantine/core/Modal";y.Root=_;y.Overlay=O;y.Content=E;y.Body=j;y.Header=N;y.Title=I;y.CloseButton=b;y.Stack=q;function P({accounts:r,isLoading:e,onDelete:s,onAccountUpdated:a,accountStats:o={},onViewDetails:n}){const c=L(),u=Q(`(max-width: ${c.breakpoints.sm})`),[m,{open:d,close:l}]=se(!1),[p,g]=C.useState(null);return e?t.jsx(ne,{children:"Loading accounts..."}):t.jsxs(t.Fragment,{children:[t.jsx(oe,{cols:{base:1,sm:2,lg:3},spacing:"lg",children:r?.map(i=>{const v=o[i.id]||{balanceHistory:[],monthlySpent:0,transactionCount:0};return t.jsx(Z,{account:i,balanceHistory:v.balanceHistory,monthlySpent:v.monthlySpent,transactionCount:v.transactionCount,onEdit:M=>{g(M),d()},onDelete:()=>s(i.id),onViewDetails:()=>n?.(i)},i.id)})}),u?t.jsx(ae,{opened:m,onClose:l,title:"Edit Account",position:"bottom",children:t.jsx("div",{children:p&&t.jsx(H,{account:p,onUpdated:()=>{l(),g(null),a()}})})}):t.jsx(y,{opened:m,onClose:l,title:"Edit Account",centered:!0,children:p&&t.jsx(H,{account:p,onUpdated:()=>{l(),g(null),a()}})})]})}P.__docgenInfo={description:"",methods:[],displayName:"AccountsTableView",props:{accounts:{required:!0,tsType:{name:"union",raw:"AccountResponse[] | undefined",elements:[{name:"Array",elements:[{name:"AccountResponse"}],raw:"AccountResponse[]"},{name:"undefined"}]},description:""},isLoading:{required:!0,tsType:{name:"boolean"},description:""},onDelete:{required:!0,tsType:{name:"signature",type:"function",raw:"(id: string) => void",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"void"}}},description:""},onAccountUpdated:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},accountStats:{required:!1,tsType:{name:"Record",elements:[{name:"string"},{name:"AccountStats"}],raw:"Record<string, AccountStats>"},description:"",defaultValue:{value:"{}",computed:!1}},onViewDetails:{required:!1,tsType:{name:"signature",type:"function",raw:"(account: AccountResponse) => void",signature:{arguments:[{type:{name:"AccountResponse"},name:"account"}],return:{name:"void"}}},description:""}}};const{expect:B,userEvent:ve,waitFor:Se,within:Me}=__STORYBOOK_MODULE_TEST__,Be=new V,st={title:"Components/Accounts/AccountsTableView",component:P,parameters:{layout:"padded"},decorators:[r=>t.jsx(z,{client:Be,children:t.jsx(r,{})})]},Ce=()=>{const[r,e]=C.useState(U),s=a=>{e(o=>o.filter(n=>n.id!==a))};return t.jsx(P,{accounts:r,isLoading:!1,onDelete:s,onAccountUpdated:()=>{}})},w={render:()=>t.jsx(Ce,{}),play:async({canvasElement:r})=>{const e=Me(r),s=e.getAllByText("Checking");await B(s.length).toBeGreaterThan(0);const a=e.getAllByText("Savings");await B(a.length).toBeGreaterThan(0);const o=e.getAllByTitle("Delete");await B(o.length).toBeGreaterThan(0),await ve.click(o[0]),await Se(()=>{const c=e.queryAllByText("Checking");B(c.length).toBe(0)});const n=e.getAllByText("Savings");await B(n.length).toBeGreaterThan(0)}},A={args:{accounts:void 0,isLoading:!0,onDelete:()=>{},onAccountUpdated:()=>{}}},T={args:{accounts:[],isLoading:!1,onDelete:()=>{},onAccountUpdated:()=>{}}};w.parameters={...w.parameters,docs:{...w.parameters?.docs,source:{originalSource:`{
  render: () => <InteractiveWrapper />,
  play: async ({
    canvasElement
  }) => {
    const canvas = within(canvasElement);

    // Check if accounts are rendered
    const checkingElements = canvas.getAllByText('Checking');
    await expect(checkingElements.length).toBeGreaterThan(0);
    const savingsElements = canvas.getAllByText('Savings');
    await expect(savingsElements.length).toBeGreaterThan(0);

    // Find the delete action buttons by title attribute
    const deleteButtons = canvas.getAllByTitle('Delete');
    await expect(deleteButtons.length).toBeGreaterThan(0);

    // Click delete for the first account (Checking account)
    await userEvent.click(deleteButtons[0]);

    // Wait for account to be removed - all "Checking" texts should be gone
    await waitFor(() => {
      const remainingChecking = canvas.queryAllByText('Checking');
      expect(remainingChecking.length).toBe(0);
    });

    // Verify "Savings" account is still present
    const remainingSavings = canvas.getAllByText('Savings');
    await expect(remainingSavings.length).toBeGreaterThan(0);
  }
}`,...w.parameters?.docs?.source}}};A.parameters={...A.parameters,docs:{...A.parameters?.docs,source:{originalSource:`{
  args: {
    accounts: undefined,
    isLoading: true,
    onDelete: () => {},
    onAccountUpdated: () => {}
  }
}`,...A.parameters?.docs?.source}}};T.parameters={...T.parameters,docs:{...T.parameters?.docs,source:{originalSource:`{
  args: {
    accounts: [],
    isLoading: false,
    onDelete: () => {},
    onAccountUpdated: () => {}
  }
}`,...T.parameters?.docs?.source}}};export{T as Empty,w as Interactive,A as Loading,st as default};
